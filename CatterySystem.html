<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AURUM MANOR | å°ˆæ¥­è²“èˆæ™ºæ…§ç‡Ÿé‹ç³»çµ± v2.3 Enterprise</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@600;700&family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        :root {
            --brand-dark: #1E1A17;
            --brand-mocha: #3E362E;
            --brand-gold: #C5A059;
            --brand-gold-pale: #E5D5B5;
            --ui-bg: #FDFCFB;
            --ui-card: #FFFFFF;
            --ui-border: #F0EBE6;
            --accent-sage: #4F6F52;
            --status-red: #D08159;
        }

        body { 
            font-family: 'Noto Sans TC', sans-serif; 
            background-color: var(--ui-bg); 
            color: var(--brand-dark);
            letter-spacing: -0.01em;
            overflow-x: hidden;
        }

        .font-serif { font-family: 'Noto Serif TC', serif; }
        
        ::-webkit-scrollbar { width: 4px; height: 4px; }
        ::-webkit-scrollbar-thumb { background: var(--brand-gold); border-radius: 10px; }

        .glass-card {
            background: var(--ui-card);
            border: 1px solid var(--ui-border);
            box-shadow: 0 12px 40px -15px rgba(42, 36, 32, 0.06);
            border-radius: 1.5rem;
        }

        .sidebar-active {
            background: linear-gradient(90deg, var(--brand-gold) 0%, #B89248 100%);
            color: white !important;
            box-shadow: 0 8px 25px -8px rgba(197, 160, 89, 0.6);
        }

        .input-premium {
            border: 1.5px solid var(--ui-border);
            border-radius: 0.875rem;
            padding: 0.875rem 1.25rem;
            transition: all 0.2s;
            background: #FFFFFF;
            color: var(--brand-dark);
        }
        .input-premium:focus {
            border-color: var(--brand-gold);
            box-shadow: 0 0 0 4px rgba(197, 160, 89, 0.1);
            outline: none;
        }

        /* å¥‘ç´„èˆ‡è¡€çµ±æ›¸å°ˆç”¨ */
        .contract-text { font-size: 13px; line-height: 1.8; color: #4A4A4A; }
        .contract-title { font-weight: 800; color: #1A1A1A; margin-bottom: 8px; border-left: 3px solid var(--brand-gold); padding-left: 10px; }
        .pedigree-branch { position: relative; padding-left: 24px; margin-top: 12px; border-left: 1px dashed var(--brand-gold-pale); }
        .pedigree-node { background: #FAF9F7; border: 1px solid var(--ui-border); padding: 8px 12px; border-radius: 8px; font-size: 11px; display: inline-block; margin-bottom: 4px; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: translateY(0); } }
        .view-animate { animation: fadeIn 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        .btn-press:active { transform: scale(0.97); }
        .status-dot { width: 8px; height: 8px; border-radius: 50%; display: inline-block; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- æ ¸å¿ƒæ¨¡æ“¬æ•¸æ“šåº« ---
        const KITTENS_DATA = [
            { id: 'K001', name: 'Mochi', breed: 'è‹±çŸ­é‡‘æ¼¸å±¤ NY12', color: 'é‡‘æ¼¸å±¤', birthday: '2023-10-15', gender: 'å…¬', status: 'åœ¨å”®', chip: '900-1122-3344', sire: 'GC RW Leo', dam: 'CH Luna', v1: 'Done', v2: 'Pending', v3: 'Pending', hcm: 'N/N', price: '125,000', age: '3å€‹æœˆ' },
            { id: 'K002', name: 'Pudding', breed: 'æ›¼èµ¤è‚¯', color: 'å¥¶æ²¹', birthday: '2023-11-01', gender: 'æ¯', status: 'å·²é è¨‚', chip: '900-5566-7788', sire: 'GC RW Leo', dam: 'Bella', v1: 'Done', v2: 'Done', v3: 'Pending', hcm: 'N/N', price: '95,000', age: '2.5å€‹æœˆ' },
            { id: 'K003', name: 'Cookie', breed: 'å¸ƒå¶è²“', color: 'æµ·è±¹é›™è‰²', birthday: '2023-09-20', gender: 'å…¬', status: 'åœ¨å”®', chip: '900-9900-1122', sire: 'Star Duke', dam: 'Princess', v1: 'Done', v2: 'Done', v3: 'Done', hcm: 'Pending', price: '88,000', age: '4å€‹æœˆ' },
        ];

        const PARENTS_DATA = [
            { id: 'P01', name: 'æ—å®¶è±ª', phone: '0912-345-678', cat: 'Pudding', satisfaction: 5, lastVisit: '2026-01-05', nextTask: 'å”®å¾Œ 7 å¤©å¥åº·å›è¨ª' },
            { id: 'P02', name: 'é™³å°ç¾', phone: '0988-112-990', cat: 'Mochi', satisfaction: 4, lastVisit: '2025-12-15', nextTask: 'çµç´®æ„é¡˜è¿½è¹¤' },
        ];

        const CONTRACT_TEMPLATES = [
            { id: 'T1', name: 'å¯µç‰©è²·è³£å¥‘ç´„æ›¸ (æ­£å¼ç‰ˆ)', code: 'PET-SALES-CONTRACT', desc: 'åŒ…å« 10 æ¢æ ¸å¿ƒæ“”ä¿æ¢æ¬¾èˆ‡èŠåœ’å°ˆå±¬é™„ç´„ç´°å‰‡ã€‚' },
            { id: 'T2', name: 'ç¹è‚²æ¬Šå—é™è½‰è®“å”è­°', code: 'BREED-EXP-V2', desc: 'é©ç”¨è¨»å†Šè²“èˆå°æ¥ï¼Œå«è¡€çµ±æˆæ¬Šèˆ‡å…¬è²“ä½¿ç”¨æ¢æ¬¾ã€‚' },
        ];

        // --- åœ–ç¤ºçµ„ä»¶ ---
        const Icon = ({ name, size = 20, className = "" }) => {
            const icons = {
                dashboard: <React.Fragment><rect width="7" height="9" x="3" y="3" rx="1"/><rect width="7" height="5" x="14" y="3" rx="1"/><rect width="7" height="9" x="14" y="12" rx="1"/><rect width="7" height="5" x="3" y="16" rx="1"/></React.Fragment>,
                cat: <path d="M12 5c.67 0 1.35.09 2 .26 1.78-2 5.03-2.84 6.42-2.26 1.4.58-.42 7-.42 7 .57 1.07 1 2.24 1 3.44C21 17.9 16.97 21 12 21S3 17.9 3 13.44c0-1.2.43-2.37 1-3.44 0 0-1.82-6.42-.42-7 1.39-.58 4.64.26 6.42 2.26.65-.17 1.33-.26 2-.26z"/>,
                medical: <React.Fragment><path d="m18 2 4 4m-5 1 3-3"/><path d="M19 9 8.7 19.3c-1 1-2.5 1-3.4 0l-.6-.6c-1-1-1-2.5 0-3.4L15 5m-6 6 4 4"/></React.Fragment>,
                legal: <React.Fragment><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><path d="M14 2v6h6m-4 5H8m8 4H8"/></React.Fragment>,
                crm: <React.Fragment><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/></React.Fragment>,
                x: <path d="M18 6 6 18M6 6l12 12"/>,
                check: <path d="M20 6 9 17l-5-5"/>,
                dna: <React.Fragment><path d="M2 15c6.667-6 13.333 0 20-6"/><path d="M9 22c1.798-1.998 2.518-3.995 2.807-5.993"/><path d="M15 2c-1.798 1.998-2.518 3.995-2.807 5.993"/></React.Fragment>,
                printer: <React.Fragment><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect width="12" height="8" x="6" y="14"/></React.Fragment>,
                heart: <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/>,
                calendar: <React.Fragment><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><path d="M16 2v4M8 2v4m-5 4h18"/></React.Fragment>,
                chart: <React.Fragment><path d="M3 3v18h18"/><path d="M18 9l-5 5-2-2-4 4"/></React.Fragment>,
                user: <React.Fragment><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></React.Fragment>,
                dollar: <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>,
                menu: <path d="M4 6h16M4 12h16M4 18h16" />
            };
            return (
                <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    {icons[name] || <circle cx="12" cy="12" r="10" />}
                </svg>
            );
        };

        // --- é€šç”¨ UI çµ„ä»¶ ---
        const Toast = ({ message, show }) => (
            <div className={`fixed bottom-10 left-1/2 -translate-x-1/2 z-[100] transition-all duration-500 ${show ? 'translate-y-0 opacity-100' : 'translate-y-20 opacity-0'}`}>
                <div className="bg-[#1E1A17] text-white px-10 py-5 rounded-full shadow-2xl flex items-center gap-4 border border-white/10 w-max max-w-[90vw]">
                    <div className="bg-emerald-500 p-1.5 rounded-full text-white shrink-0"><Icon name="check" size={16} /></div>
                    <span className="font-bold tracking-widest text-sm text-white">{message}</span>
                </div>
            </div>
        );

        const Modal = ({ isOpen, onClose, title, children }) => {
            if (!isOpen) return null;
            return (
                <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-[#1E1A17]/85 backdrop-blur-md animate-fade-in text-gray-800">
                    <div className="bg-white rounded-[2rem] md:rounded-[2.5rem] shadow-2xl w-[95%] md:w-full md:max-w-4xl max-h-[90vh] flex flex-col overflow-hidden border border-white/20">
                        <div className="px-6 md:px-10 py-4 md:py-6 border-b border-gray-100 flex justify-between items-center bg-gray-50/50 shrink-0">
                            <h3 className="text-lg md:text-xl font-bold font-serif text-gray-800 tracking-wide line-clamp-1">{title}</h3>
                            <button onClick={onClose} className="p-2 hover:bg-gray-200 rounded-full transition text-gray-400 font-bold shrink-0">
                                <Icon name="x" size={24}/>
                            </button>
                        </div>
                        <div className="p-6 md:p-10 overflow-y-auto">{children}</div>
                    </div>
                </div>
            );
        };

        const Card = ({ title, children, className = "", action }) => (
            <div className={`glass-card p-6 md:p-8 ${className}`}>
                {(title || action) && (
                    <div className="flex flex-wrap gap-4 justify-between items-center mb-6 border-b border-gray-100 pb-4 text-gray-800">
                        <h4 className="text-lg font-bold tracking-tight">{title}</h4>
                        {action}
                    </div>
                )}
                {children}
            </div>
        );

        // --- ä¸»æ‡‰ç”¨ç¨‹åº ---
        function App() {
            const [activeTab, setActiveTab] = useState('dashboard');
            const [modal, setModal] = useState({ type: null, data: null });
            const [toast, setToast] = useState({ show: false, msg: '' });
            const [isBusy, setIsBusy] = useState(false);
            const [mobileMenuOpen, setMobileMenuOpen] = useState(false); // æ–°å¢æ‰‹æ©Ÿé¸å–®ç‹€æ…‹
            
            // å¥‘ç´„è¡¨å–® State
            const [contractForm, setContractForm] = useState({
                buyerName: '', buyerPhone: '', buyerID: '', buyerAddress: '', buyerBirthday: '', buyerEmail: '',
                totalPrice: '', deliveryDate: '', paymentMode: 'å…¨é¡ä»˜æ¸…', paymentMethod: 'è½‰å¸³',
                kittenId: '', agree: false, signed: false
            });

            const showToast = (msg) => {
                setToast({ show: true, msg });
                setTimeout(() => setToast({ show: false, msg: '' }), 3000);
            };

            const NavItem = ({ id, label, icon }) => (
                <button
                    onClick={() => { setActiveTab(id); setMobileMenuOpen(false); }}
                    className={`w-full flex items-center gap-5 px-8 py-5 rounded-[1.5rem] transition-all font-bold tracking-widest text-sm mb-2 ${
                        activeTab === id ? 'sidebar-active shadow-lg' : 'text-gray-400 hover:text-white hover:bg-white/5'
                    }`}
                >
                    <Icon name={icon} />
                    <span>{label}</span>
                </button>
            );

            // --- å‹•ä½œè™•ç† ---

            const handleSigning = () => {
                setIsBusy(true);
                setTimeout(() => {
                    setIsBusy(false);
                    setModal({ type: 'sign_success' });
                }, 2000);
            };

            const handleCrmSubmit = (e) => {
                e.preventDefault();
                setIsBusy(true);
                setTimeout(() => {
                    setIsBusy(false);
                    setModal({ type: 'success_feedback', data: 'å®¶é•·å›è¨ªè¨˜éŒ„å·²æˆåŠŸå­˜æª”ï¼Œä¸‹æ¬¡æé†’å·²åŒæ­¥è‡³ç³»çµ±ã€‚' });
                    showToast('æ•¸æ“šå·²åŠ å¯†å‚™ä»½');
                }, 1500);
            };

            const handleVaccineSubmit = (e) => {
                e.preventDefault();
                setIsBusy(true);
                setTimeout(() => {
                    setIsBusy(false);
                    setModal({ type: 'success_feedback', data: 'é†«ç™‚é˜²ç–«æ•¸æ“šå·²å®Œæˆç™»è¨˜ï¼Œæ¥ç¨®è­‰æ›¸é›»å­ç‰ˆå·²ç”Ÿæˆã€‚' });
                    showToast('å¥åº·ç¶²å·²æ›´æ–°');
                }, 1500);
            };

            const proceedToPreview = (e) => {
                e.preventDefault();
                const kitten = KITTENS_DATA.find(k => k.id === contractForm.kittenId);
                setModal({ type: 'preview', data: { ...contractForm, kitten } });
            };

            // --- è¦–åœ–çµ„ä»¶ ---

            const DashboardView = () => (
                <div className="space-y-8 view-animate">
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 text-gray-800">
                        {[
                            { t: 'æœ¬æœˆç‡Ÿæ”¶åˆ©æ½¤', v: '$42,500', s: 'è¼ƒä¸ŠæœŸ +15.4%', c: 'text-[#C5A059]' },
                            { t: 'åœ¨åº«è³‡ç”¢å¸‚å€¼', v: '$1.42M', s: 'ä¾ç›®å‰è¡Œæƒ…ä¼°ç®—', c: 'text-amber-500' },
                            { t: 'é è¨‚è½‰åŒ–æŒ‡æ¨™', v: '78.2%', s: 'æˆé•·è¶¨å‹¢ç©©å®š', c: 'text-emerald-500' },
                            { t: 'ç·Šæ€¥å¥åº·è­¦ç¤º', v: '2 ç­†', s: 'éœ€åœ¨ 24h å…§è™•ç†', c: 'text-rose-500' }
                        ].map((s, i) => (
                            <div key={i} className="glass-card p-6 border-b-4 border-b-[#C5A059]">
                                <p className="text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-2">{s.t}</p>
                                <h4 className="text-3xl font-bold">{s.v}</h4>
                                <p className={`text-[10px] font-bold mt-2 ${s.c}`}>{s.s}</p>
                            </div>
                        ))}
                    </div>
                    <div className="grid grid-cols-1 lg:grid-cols-12 gap-8">
                        <Card title="èŠåœ’æ ¸å¿ƒä»»å‹™æ—¥èªŒ" className="col-span-1 lg:col-span-8">
                            <div className="space-y-4">
                                {[
                                    { m: 'Mochi ç–«è‹— II æ¥ç¨®äº‹ä»¶ç™»è¨˜', time: 'ä»Šæ—¥ 14:00', type: 'med' },
                                    { m: 'æ—å®¶è±ª å®¶é•· å”®å¾Œ 7 å¤©å›è¨ªè¿½è¹¤', time: 'æ˜æ—¥ 10:00', type: 'crm' },
                                    { m: 'ç”¢å‡ºæ­£å¼è²·è³£å¥‘ç´„å‰¯æœ¬ (CON-092)', time: '1æœˆ20æ—¥', type: 'legal' }
                                ].map((t, i) => (
                                    <div key={i} className="flex flex-col md:flex-row md:justify-between md:items-center p-5 bg-[#FAF9F7] rounded-2xl border border-transparent hover:border-amber-200 transition cursor-pointer gap-3 md:gap-0">
                                        <div className="flex items-center gap-4">
                                            <div className={`p-3 rounded-xl ${t.type === 'med' ? 'bg-rose-50 text-rose-500' : 'bg-amber-50 text-amber-500'}`}><Icon name={t.type === 'med' ? 'medical' : 'crm'} size={18}/></div>
                                            <span className="font-bold text-gray-800 text-sm">{t.m}</span>
                                        </div>
                                        <span className="text-[10px] font-bold text-gray-400 pl-14 md:pl-0">{t.time}</span>
                                    </div>
                                ))}
                            </div>
                        </Card>
                        <div className="col-span-1 lg:col-span-4 bg-[#1E1A17] rounded-[2rem] p-8 md:p-10 text-white relative overflow-hidden shadow-2xl">
                             <div className="relative z-10">
                                <h4 className="text-2xl font-serif font-bold mb-6 text-[#C5A059]">ç‡Ÿé‹è¶¨å‹¢å ±å‘Š</h4>
                                <div className="space-y-6">
                                    <div className="p-4 bg-white/5 rounded-xl border border-white/10">
                                        <p className="text-[10px] text-gray-400 mb-1 font-bold tracking-widest uppercase">æˆé•·é æ¸¬</p>
                                        <p className="text-3xl font-serif font-bold text-emerald-400">+18.4%</p>
                                    </div>
                                    <button onClick={() => setModal({type: 'financial_analysis'})} className="w-full py-4 bg-[#C5A059] rounded-xl font-bold text-sm hover:bg-[#AF8E4D] transition shadow-lg btn-press text-white">ç”¢å‡ºç‡Ÿé‹åˆ©æ½¤åˆ†æ</button>
                                </div>
                             </div>
                             <Icon name="chart" size={150} className="absolute -right-10 -bottom-10 opacity-10 rotate-12 text-[#C5A059]" />
                        </div>
                    </div>
                </div>
            );

            const InventoryView = () => (
                <div className="view-animate">
                    <Card title="åœ¨åº«è¡€çµ±é«”ç³»æª”æ¡ˆåº«" className="overflow-x-auto">
                        <div className="min-w-[800px]">
                            <table className="w-full text-left text-gray-800 font-bold">
                                <thead>
                                    <tr className="text-[10px] text-gray-400 uppercase tracking-widest font-bold">
                                        <th className="px-6 py-4">è²“éš»å‘¼å</th><th className="px-6 py-4">å“ç¨®èˆ‡æ¯›è‰²</th><th className="px-6 py-4">æ™¶ç‰‡ç·¨è™Ÿ</th><th className="px-6 py-4">ç›®å‰ç‹€æ…‹</th><th className="px-6 py-4 text-right">ç®¡ç†</th>
                                    </tr>
                                </thead>
                                <tbody className="text-sm">
                                    {KITTENS_DATA.map(k => (
                                        <tr key={k.id} className="hover:bg-gray-50 border-b border-gray-50 last:border-0 transition">
                                            <td className="px-6 py-6 font-serif">{k.name}</td>
                                            <td className="px-6 py-6 text-gray-500 font-medium">{k.breed}</td>
                                            <td className="px-6 py-6 font-mono text-gray-400">{k.chip}</td>
                                            <td className="px-6 py-6"><span className="flex items-center gap-2"><div className={`status-dot ${k.status === 'åœ¨å”®' ? 'bg-emerald-500' : 'bg-amber-500'}`}></div> {k.status}</span></td>
                                            <td className="px-6 py-6 text-right"><button onClick={() => setModal({type: 'kitten_detail', data: k})} className="text-[#C5A059] hover:underline btn-press">æª¢è¦–è©³ç´°æª”æ¡ˆ</button></td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    </Card>
                </div>
            );

            const MedicalView = () => (
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-8 view-animate">
                    <Card title="é˜²ç–«æ¥ç¨®ç›£æ§çŸ©é™£">
                        <div className="space-y-4 text-gray-800">
                            {KITTENS_DATA.map(k => (
                                <div key={k.id} className="p-6 border border-gray-100 rounded-2xl bg-white shadow-sm hover:border-[#C5A059] transition">
                                    <div className="flex justify-between mb-4 font-bold"><span>{k.name}</span><span className="text-[10px] text-[#C5A059] uppercase font-mono tracking-widest">HCM: {k.hcm}</span></div>
                                    <div className="flex gap-2">
                                        {[k.v1, k.v2, k.v3].map((v, i) => <div key={i} className={`flex-1 h-2 rounded-full ${v !== 'Pending' ? 'bg-[#C5A059]' : 'bg-gray-100'}`}></div>)}
                                    </div>
                                    <div className="mt-4 flex justify-between items-center text-[10px] font-bold">
                                        <span className="text-gray-400 font-mono tracking-tighter uppercase">Health Rank: Elite</span>
                                        <button onClick={() => setModal({type: 'vaccine_scheduler', data: k})} className="text-[#C5A059] hover:underline btn-press">ç™»è¨˜å°ˆæ¥­æ¥ç¨®äº‹ä»¶</button>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </Card>
                    <Card title="ç”Ÿç‰©å®‰å…¨åˆè¦å ±å‘Šåº«">
                         <div className="space-y-3">
                            {['å¹´åº¦éºå‚³ç—…ç¯©æª¢åŒ¯ç¸½ (PDF)', 'åœ¨èˆå¹¼è²“é©…èŸ²é€±æœŸè¡¨', 'ç’°å¢ƒé˜²ç–«æ¶ˆæ¯’æ—¥èªŒ'].map(doc => (
                                <div key={doc} className="p-5 bg-[#FAF9F7] rounded-xl flex justify-between items-center border border-transparent hover:border-[#E5D5B5] cursor-pointer group transition shadow-sm">
                                    <span className="text-sm font-bold text-gray-600 group-hover:text-gray-800">{doc}</span>
                                    <Icon name="legal" size={14} className="text-gray-300" />
                                </div>
                            ))}
                         </div>
                    </Card>
                </div>
            );

            const LegalView = () => (
                <div className="grid grid-cols-1 lg:grid-cols-12 gap-8 view-animate">
                    <div className="col-span-1 lg:col-span-5 space-y-6 text-gray-800">
                        <Card title="æ­£å¼å¥‘ç´„ç¯„æœ¬ä¸­å¿ƒ">
                            <div className="space-y-4">
                                {CONTRACT_TEMPLATES.map(t => (
                                    <div 
                                        key={t.id} 
                                        onClick={() => setModal({type: 'wizard', data: t})}
                                        className="p-6 border border-gray-100 rounded-2xl hover:border-[#C5A059] cursor-pointer transition-all shadow-sm group bg-white hover:shadow-lg"
                                    >
                                        <div className="flex justify-between items-center mb-3">
                                            <h5 className="font-bold text-lg">{t.name}</h5>
                                            <Icon name="legal" size={18} className="text-gray-200 group-hover:text-[#C5A059]" />
                                        </div>
                                        <p className="text-[11px] text-gray-400 font-medium leading-relaxed">{t.desc}</p>
                                    </div>
                                ))}
                            </div>
                        </Card>
                    </div>
                    <div className="col-span-1 lg:col-span-7">
                        <Card title="å±¥ç´„é€²åº¦å¯¦æ™‚è¿½è¹¤">
                            <div className="space-y-4 text-gray-800">
                                {[
                                    { name: 'æ—å®¶è±ª', kitten: 'Pudding', status: 'å¾…ç°½ç½²', color: 'text-amber-500' },
                                    { name: 'é™³å°ç¾', kitten: 'Mochi', status: 'ç”Ÿæ•ˆä¸­', color: 'text-emerald-600' }
                                ].map((c, i) => (
                                    <div key={i} className="p-6 bg-gray-50 rounded-2xl flex justify-between items-center border border-transparent hover:border-amber-200 transition shadow-sm">
                                        <div className="flex items-center gap-5">
                                            <div className="p-3 bg-white rounded-xl shadow-sm text-gray-400 hidden sm:block"><Icon name="legal"/></div>
                                            <div><p className="font-bold">{c.name} å®¶é•·</p><p className="text-[10px] text-gray-400 font-bold uppercase tracking-widest font-mono">ID: {c.kitten}</p></div>
                                        </div>
                                        <span className={`text-[10px] font-extrabold uppercase tracking-widest ${c.color} bg-white px-4 py-2 rounded-full shadow-sm`}>{c.status}</span>
                                    </div>
                                ))}
                            </div>
                        </Card>
                    </div>
                </div>
            );

            const CRMView = () => (
                <div className="grid grid-cols-1 lg:grid-cols-3 gap-8 view-animate text-gray-800 font-bold">
                    <div className="lg:col-span-2 space-y-6">
                        {PARENTS_DATA.map(p => (
                            <Card key={p.id}>
                                <div className="flex flex-col md:flex-row md:justify-between md:items-center gap-6">
                                    <div className="flex gap-6 items-center">
                                        <div className="w-16 h-16 rounded-3xl bg-gray-100 flex items-center justify-center font-bold text-2xl text-gray-400 border border-gray-200 shadow-inner shrink-0">{p.name[0]}</div>
                                        <div><h4 className="text-xl font-bold">{p.name}</h4><p className="text-sm font-bold text-[#C5A059] mt-1 uppercase tracking-widest font-mono">{p.cat} çš„å®¶é•·</p></div>
                                    </div>
                                    <div className="text-left md:text-right">
                                        <p className="text-[10px] font-bold text-rose-500 uppercase tracking-widest mb-2 flex items-center gap-1 md:justify-end"><Icon name="calendar" size={12}/> ä¸‹æ¬¡ä»»å‹™ï¼š{p.nextTask}</p>
                                        <button onClick={() => setModal({type: 'crm_log', data: p})} className="w-full md:w-auto px-6 py-2 bg-[#1E1A17] text-[#C5A059] rounded-xl text-[10px] font-extrabold uppercase tracking-[0.2em] btn-press shadow-md">ç™»è¨˜äº’å‹•ç´€éŒ„</button>
                                    </div>
                                </div>
                            </Card>
                        ))}
                    </div>
                    <Card title="èŠåœ’å¥½è©•çŸ©é™£åˆ†æ">
                         <div className="text-center py-10 bg-[#FAF9F7] rounded-3xl mb-8 border border-[#F0EBE6]">
                            <p className="text-6xl font-serif font-bold text-[#C5A059]">4.9</p>
                            <p className="text-[10px] font-bold text-gray-400 uppercase mt-4 tracking-widest font-mono">Overall Satisfaction</p>
                         </div>
                         <div className="space-y-4 px-2">
                             {[5, 4, 3].map(star => (
                                 <div key={star} className="flex items-center gap-4">
                                     <span className="text-[10px] font-bold w-4 text-gray-400">{star} â˜…</span>
                                     <div className="flex-1 h-1.5 bg-gray-100 rounded-full overflow-hidden"><div className="h-full bg-[#C5A059]" style={{width: star === 5 ? '92%' : '8%'}}></div></div>
                                 </div>
                             ))}
                         </div>
                    </Card>
                </div>
            );

            // å´é‚Šæ¬„çµ„ä»¶ (Desktop + Mobile Overlay)
            const SidebarContent = () => (
                <div className="flex flex-col h-full p-10">
                    <div className="mb-16 text-center border-b border-white/5 pb-8">
                        <h1 className="text-3xl font-serif font-bold tracking-[0.2em] text-[#C5A059]">å¥§å€«èŠåœ’</h1>
                        <p className="text-[9px] uppercase tracking-[0.4em] mt-3 opacity-40 font-bold">Elite Cattery Management</p>
                    </div>
                    <nav className="flex-1 space-y-3">
                        <NavItem id="dashboard" label="ç‡Ÿé‹é¢æ¿" icon="dashboard" />
                        <NavItem id="inventory" label="è¡€çµ±é«”ç³»" icon="cat" />
                        <NavItem id="medical" label="é˜²ç–«ç›£æ§" icon="medical" />
                        <NavItem id="legal" label="æ³•å‹™ä¸­å¿ƒ" icon="legal" />
                        <NavItem id="crm" label="å®¶é•·é—œä¿‚" icon="crm" />
                    </nav>
                    <div className="mt-auto p-6 bg-white/5 rounded-3xl border border-white/10 flex items-center gap-4">
                        <div className="w-12 h-12 rounded-2xl bg-[#C5A059] flex items-center justify-center font-bold text-xl shadow-lg border border-white/10">A</div>
                        <div className="flex-1 font-bold leading-tight tracking-widest uppercase"><p className="text-sm">Admin</p><p className="text-[10px] text-gray-500">Enterprise</p></div>
                    </div>
                </div>
            );

            return (
                <div className="min-h-screen flex relative">
                    <Toast message={toast.msg} show={toast.show} />
                    
                    {/* æ‰‹æ©Ÿç‰ˆé®ç½©èˆ‡å´é‚Šæ¬„ */}
                    {mobileMenuOpen && (
                        <div className="fixed inset-0 z-40 bg-black/50 backdrop-blur-sm lg:hidden" onClick={() => setMobileMenuOpen(false)}>
                            <div className="w-80 bg-[#1E1A17] text-white h-full shadow-2xl relative" onClick={e => e.stopPropagation()}>
                                <button onClick={() => setMobileMenuOpen(false)} className="absolute top-4 right-4 text-white p-2"><Icon name="x" size={24}/></button>
                                <SidebarContent />
                            </div>
                        </div>
                    )}

                    {/* æ¡Œé¢ç‰ˆå´é‚Šæ¬„ */}
                    <aside className="w-80 bg-[#1E1A17] text-white hidden lg:flex flex-col sticky top-0 h-screen z-20 shadow-2xl shrink-0">
                        <SidebarContent />
                    </aside>

                    <main className="flex-1 p-4 md:p-12 overflow-y-auto w-full">
                        <div className="max-w-6xl mx-auto">
                            <header className="flex flex-col md:flex-row md:justify-between md:items-end mb-8 md:mb-12 pb-6 md:pb-8 border-b border-gray-100 gap-6 md:gap-0">
                                <div className="flex items-center gap-4 md:block">
                                    <button onClick={() => setMobileMenuOpen(true)} className="lg:hidden p-2 -ml-2 text-gray-600 hover:bg-gray-100 rounded-xl"><Icon name="menu" size={28}/></button>
                                    <div>
                                        <h2 className="text-xs md:text-sm font-bold text-gray-400 uppercase tracking-[0.3em]">Operational Suite</h2>
                                        <h3 className="text-2xl md:text-4xl font-serif font-bold mt-2 md:mt-3 text-gray-800 tracking-tight">
                                            {activeTab === 'dashboard' && 'ç‡Ÿé‹åˆ†æèˆ‡è¶¨å‹¢'}
                                            {activeTab === 'inventory' && 'è¡€çµ±æª”æ¡ˆè³‡ç”¢'}
                                            {activeTab === 'medical' && 'ç”Ÿç‰©å¥åº·é˜²è­·'}
                                            {activeTab === 'legal' && 'æ•¸ä½åˆè¦ç®¡ç†'}
                                            {activeTab === 'crm' && 'å®¶é•·æœå‹™ä¸­å¿ƒ'}
                                        </h3>
                                    </div>
                                </div>
                                <button onClick={() => setModal({type: 'global_create'})} className="px-6 py-3 md:px-8 md:py-4 bg-[#C5A059] text-white rounded-2xl font-bold text-xs shadow-xl hover:bg-[#AF8E4D] transition-all uppercase tracking-widest btn-press w-full md:w-auto">+ éŒ„å…¥æ–°æ•¸æ“šè³‡æº</button>
                            </header>

                            {activeTab === 'dashboard' && <DashboardView />}
                            {activeTab === 'inventory' && <InventoryView />}
                            {activeTab === 'medical' && <MedicalView />}
                            {activeTab === 'legal' && <LegalView />}
                            {activeTab === 'crm' && <CRMView />}
                        </div>
                    </main>

                    {/* --- Modals å°ˆæ¥­å¯¦è£ --- */}

                    {/* 1. å›è¨ªç´€éŒ„ Modal */}
                    <Modal isOpen={modal.type === 'crm_log'} onClose={() => setModal({type: null})} title={`ç™»è¨˜å”®å¾Œå›è¨ªï¼š${modal.data?.name || ''}`}>
                        <form onSubmit={handleCrmSubmit} className="space-y-8 text-gray-800 font-bold">
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div className="space-y-3"><label className="text-[11px] font-bold text-gray-400 uppercase tracking-widest ml-1">æºé€šç®¡é“</label><select className="w-full input-premium font-bold text-sm bg-gray-50 appearance-none"><option>Line è¨Šæ¯</option><option>é›»è©±è¯ç¹«</option><option>åº—é¢è¦ªè¨ª</option></select></div>
                                <div className="space-y-3"><label className="text-[11px] font-bold text-gray-400 uppercase tracking-widest ml-1">æ»¿æ„åº¦è©•åˆ†</label>
                                <div className="flex gap-4 p-3 bg-gray-50 rounded-xl justify-center">{[1, 2, 3, 4, 5].map(s => <button key={s} type="button" className={`text-xl transition ${s <= 4 ? 'text-amber-500' : 'text-gray-300'}`}>â˜…</button>)}</div></div>
                            </div>
                            <div className="space-y-3"><label className="text-[11px] font-bold text-gray-400 uppercase tracking-widest ml-1">è²“éš»é©æ‡‰æ ¸å¿ƒæŒ‡æ¨™ (Checklist)</label>
                            <div className="grid grid-cols-2 md:grid-cols-3 gap-4 text-xs">{['é£Ÿæ…¾æ­£å¸¸', 'ç²¾ç¥æ´»æ½‘', 'æ’æ³„ç©©å®š', 'æ›ç³§é †åˆ©', 'ç„¡éæ•åæ‡‰'].map(tag => <label key={tag} className="flex items-center gap-3 p-4 bg-gray-50 rounded-xl border border-transparent hover:border-[#C5A059] cursor-pointer"><input type="checkbox" defaultChecked className="w-5 h-5 rounded border-gray-300 text-[#C5A059]" /><span>{tag}</span></label>)}</div></div>
                            <textarea required className="w-full input-premium h-32 font-medium" placeholder="è«‹è©³ç´°ç´€éŒ„å®¶é•·åé¥‹çš„é‡é»ï¼Œä¾‹å¦‚é¤µé£Ÿé‡æˆ–æ´»å‹•åŠ›è§€å¯Ÿ..."></textarea>
                            <div className="pt-6 border-t border-gray-100 flex flex-col md:flex-row gap-4">
                                <div className="flex-1"><label className="text-[11px] font-bold text-gray-400 uppercase mb-2 block">ä¸‹æ¬¡è¯ç¹«æ—¥</label><input type="date" className="w-full input-premium text-xs font-bold" defaultValue="2026-02-20" /></div>
                                <button type="submit" disabled={isBusy} className="flex-[2] py-4 bg-[#C5A059] text-white rounded-2xl font-bold shadow-xl hover:bg-[#AF8E4D] btn-press uppercase tracking-widest text-sm">{isBusy ? 'æ­£åœ¨æ›´æ–°æª”æ¡ˆ...' : 'ç¢ºèªä¸¦å„²å­˜å›è¨ªæª”æ¡ˆ'}</button>
                            </div>
                        </form>
                    </Modal>

                    {/* 2. ç‡Ÿé‹åˆ†æå ±å‘Š Modal (æœ‰ç”¨åŠŸèƒ½) */}
                    <Modal isOpen={modal.type === 'financial_analysis'} onClose={() => setModal({type: null})} title="ç‡Ÿé‹åˆ©æ½¤åˆ†æèˆ‡è³‡ç”¢å›å ±">
                        <div className="space-y-8 text-gray-800 font-bold view-animate">
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div className="p-8 bg-emerald-50 rounded-[2rem] border border-emerald-100 relative overflow-hidden"><p className="text-[10px] text-emerald-600 font-bold uppercase mb-2 tracking-widest">é è¨ˆæ·¨åˆ©ç‡ (Q1)</p><h4 className="text-5xl font-serif font-bold text-emerald-800">42.8%</h4></div>
                                <div className="p-8 bg-blue-50 rounded-[2rem] border border-blue-100"><p className="text-[10px] text-blue-600 font-bold uppercase mb-2 tracking-widest">é¸è³¼è½‰åŒ–ç‡</p><h4 className="text-5xl font-serif font-bold text-blue-800">18.5%</h4></div>
                            </div>
                            <div className="space-y-4">
                                <h5 className="text-[10px] uppercase font-bold text-gray-400 border-b pb-3 tracking-widest">é—œéµç‡Ÿé‹æ´å¯Ÿ</h5>
                                {[ {l:'é«˜éšé‡‘æ¼¸å±¤æº¢åƒ¹èƒ½åŠ›æå‡', v:'å»ºè­°å„ªåŒ–ç¹è‚²ç·š'}, {l:'é˜²ç–«æˆæœ¬æ§åˆ¶æ•ˆç‡å„ªæ–¼æ¥­ç•Œ', v:'ç¶­æŒç›®å‰çš„ç”Ÿç‰©å®‰å…¨è¦ç¯„'}, {l:'å®¶é•·è½‰ä»‹ç´¹ç‡å¸¶å‹•ä¹‹ç²å®¢æˆæœ¬ä¸‹é™', v:'æŒçºŒæ¨å‹•å”®å¾Œé—œæ‡·'} ].map((r,i) => <div key={i} className="flex justify-between items-center p-4 bg-gray-50 rounded-xl border border-gray-100"><span className="text-xs">{r.l}</span><span className="text-[10px] font-bold bg-[#C5A059] text-white px-3 py-1 rounded-full shadow-sm text-center min-w-[80px]">{r.v}</span></div>)}
                            </div>
                            <button onClick={() => { setModal({type: null}); showToast('åˆ©æ½¤åˆ†æ PDF å·²ç™¼é€è‡³ç®¡ç†å“¡ä¿¡ç®±'); }} className="w-full py-5 bg-[#1E1A17] text-[#C5A059] rounded-2xl font-bold shadow-2xl btn-press flex items-center justify-center gap-3"><Icon name="printer" /> åŒ¯å‡ºèŠåœ’å¹´åº¦ç¶“ç‡Ÿåˆ©æ½¤å ±å‘Š</button>
                        </div>
                    </Modal>

                    {/* 3. å°ˆæ¥­æ¥ç¨®äº‹ä»¶ Modal (å–ä»£åŸæœ¬è‡¨åºŠæ—¥èªŒ) */}
                    <Modal isOpen={modal.type === 'vaccine_scheduler'} onClose={() => setModal({type: null})} title={`ç™»è¨˜å°ˆæ¥­é˜²ç–«æ¥ç¨®ï¼š${modal.data?.name || ''}`}>
                        <form onSubmit={handleVaccineSubmit} className="space-y-8 text-gray-800 font-bold">
                            <div className="p-6 bg-[#FAF9F7] rounded-3xl border border-[#F0EBE6] flex flex-col md:flex-row items-center gap-6 shadow-inner text-center md:text-left"><div className="w-20 h-20 bg-white rounded-2xl flex items-center justify-center text-4xl shadow-sm border border-gray-100">ğŸ’‰</div><div><p className="text-sm font-bold uppercase tracking-widest">ç›®å‰é€²åº¦: {modal.data?.v1 === 'Done' ? 'äºŒåŠ‘æ¥ç¨® (Step 2)' : 'ä¸€åŠ‘æ¥ç¨® (Step 1)'}</p><p className="text-[11px] text-gray-400 mt-2 italic leading-relaxed">æ¥ç¨®å¾Œå°‡è‡ªå‹•æ’å®š 21 å¤©å¾Œçš„è£œå¼·è­¦ç¤ºï¼Œä¸¦ç”¢å‡ºé›»å­å¥åº·è­‰æ˜å‰¯æœ¬ã€‚</p></div></div>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div className="space-y-2"><label className="text-[11px] font-bold text-gray-400 uppercase tracking-widest ml-1">ç–«è‹—å» ç‰Œèˆ‡ç¨®é¡</label><select className="w-full input-premium font-bold text-sm bg-white"><option>å¦™ä¸‰å¤š Nobivac Tricat</option><option>å¯Œé“ Fel-O-Vax</option></select></div>
                                <div className="space-y-2"><label className="text-[11px] font-bold text-gray-400 uppercase tracking-widest ml-1">æ‰¹è™Ÿ (Batch Lot)</label><input required className="w-full input-premium font-mono" placeholder="ä¾‹: 2026-X12" /></div>
                                <div className="space-y-2"><label className="text-[11px] font-bold text-gray-400 uppercase tracking-widest ml-1">åŸ·è¡Œé†«äº‹æ©Ÿæ§‹</label><input required className="w-full input-premium" placeholder="è¼¸å…¥å‹•ç‰©é†«é™¢åç¨±" /></div>
                                <div className="space-y-2"><label className="text-[11px] font-bold text-gray-400 uppercase tracking-widest ml-1">æ¥ç¨®å¯¦éš›æ—¥æœŸ</label><input required type="date" className="w-full input-premium font-bold" defaultValue="2026-01-18" /></div>
                            </div>
                            <div className="space-y-2"><label className="text-[11px] font-bold text-gray-400 uppercase tracking-widest ml-1">è¡“å¾Œç‹€æ…‹è§€å¯Ÿå‚™è¨»</label><textarea className="w-full input-premium h-24 font-medium" placeholder="é£Ÿæ…¾æ˜¯å¦æ¸›é€€ã€é«”æº«ã€å±€éƒ¨éæ•åæ‡‰ç´€éŒ„..."></textarea></div>
                            <button type="submit" disabled={isBusy} className="w-full py-5 bg-emerald-800 text-white rounded-2xl font-bold shadow-xl btn-press tracking-widest uppercase text-xs">{isBusy ? 'æ•¸æ“šåŠ å¯†åŒæ­¥ä¸­...' : 'ç¢ºèªä¸¦ç”¢å‡ºé˜²ç–«æ¥ç¨®æ­£å¼ç´€éŒ„'}</button>
                        </form>
                    </Modal>

                    {/* 4. åˆç´„å¼•å° Modal (ä¿ç•™ 10 æ¢æ­£å¼æ¢æ¬¾æµç¨‹) */}
                    <Modal isOpen={modal.type === 'wizard'} onClose={() => setModal({type: null})} title="å•Ÿå‹•è²·è³£äº¤æ˜“å¥‘ç´„è‰æ“¬">
                        <form onSubmit={proceedToPreview} className="space-y-8 text-gray-800 font-bold">
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div className="space-y-2"><label className="text-[10px] font-bold text-gray-400 uppercase tracking-widest ml-1">è²·æ–¹å§“å *</label><input required className="w-full input-premium" value={contractForm.buyerName} onChange={e => setContractForm({...contractForm, buyerName: e.target.value})} /></div>
                                <div className="space-y-2"><label className="text-[10px] font-bold text-gray-400 uppercase tracking-widest ml-1">èº«åˆ†è­‰å­—è™Ÿ *</label><input required className="w-full input-premium" value={contractForm.buyerID} onChange={e => setContractForm({...contractForm, buyerID: e.target.value})} /></div>
                                <div className="md:col-span-2 space-y-2"><label className="text-[10px] font-bold text-gray-400 uppercase tracking-widest ml-1">è²·æ–¹æ”¶ä»¶åœ°å€ *</label><input required className="w-full input-premium" value={contractForm.buyerAddress} onChange={e => setContractForm({...contractForm, buyerAddress: e.target.value})} /></div>
                                <div className="space-y-2"><label className="text-[10px] font-bold text-gray-400 uppercase tracking-widest ml-1">æ¨™çš„è²“éš»æª”æ¡ˆ *</label>
                                    <select required className="w-full input-premium appearance-none bg-white cursor-pointer" value={contractForm.kittenId} onChange={e => setContractForm({...contractForm, kittenId: e.target.value})}>
                                        <option value="">é¸æ“‡æ¨™çš„...</option>{KITTENS_DATA.map(k => <option key={k.id} value={k.id}>{k.name} ({k.breed})</option>)}
                                    </select>
                                </div>
                                <div className="space-y-2"><label className="text-[10px] font-bold text-gray-400 uppercase tracking-widest ml-1">æˆäº¤ç¸½åƒ¹ *</label><input required type="number" className="w-full input-premium" value={contractForm.totalPrice} onChange={e => setContractForm({...contractForm, totalPrice: e.target.value})} /></div>
                            </div>
                            <button type="submit" className="w-full py-5 bg-[#C5A059] text-white rounded-2xl font-bold shadow-xl btn-press uppercase tracking-widest">ç”Ÿæˆæ•¸ä½å‰¯æœ¬ä¸¦é€²å…¥æ³•å¾‹æ¢æ¬¾æ ¸å°</button>
                        </form>
                    </Modal>

                    {/* 5. å¥‘ç´„é è¦½ Modal (å®Œå…¨å¯¦è£ 10 æ¢æ¢æ¬¾èˆ‡ç°½ç« ) */}
                    <Modal isOpen={modal.type === 'preview'} onClose={() => setModal({type: null})} title="æ•¸ä½å¥‘ç´„æ³•å¾‹å‰¯æœ¬æ ¸å°">
                        <div className="space-y-8 animate-pop text-gray-800">
                            <div className="bg-[#FFFCFA] p-6 md:p-12 rounded-[2rem] md:rounded-[2.5rem] border-2 border-[#F0EBE6] shadow-inner font-serif contract-text relative overflow-hidden">
                                <div className="absolute inset-0 flex items-center justify-center opacity-[0.03] rotate-45 pointer-events-none text-4xl md:text-7xl font-bold uppercase tracking-tighter">Aurum Manor Official</div>
                                <div className="text-center border-b-2 border-[#C5A059] pb-8 mb-10"><h4 className="text-2xl md:text-3xl font-bold tracking-[0.5em] uppercase text-gray-900 font-bold">å¯µç‰©è²·è³£å¥‘ç´„æ›¸</h4><p className="text-[8px] md:text-[10px] mt-3 font-sans font-extrabold text-[#A8A29E] tracking-[0.3em] uppercase">PET SALES CONTRACT | DIGITAL COPY</p></div>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-10 mb-10 text-sm font-bold">
                                    <div className="space-y-2"><h6 className="text-xs uppercase text-[#C5A059] mb-2 font-bold tracking-widest">è²·æ–¹ (ä¹™æ–¹)</h6><p>å§“åï¼š{modal.data?.buyerName}</p><p>èº«åˆ†è­‰ï¼š{modal.data?.buyerID}</p></div>
                                    <div className="space-y-2"><h6 className="text-xs uppercase text-[#C5A059] mb-2 font-bold tracking-widest">æ¨™çš„ç‰©</h6><p>å‘¼åï¼š{modal.data?.kitten?.name}</p><p>å“ç¨®ï¼š{modal.data?.kitten?.breed}</p></div>
                                </div>
                                <div className="space-y-6">
                                    <div className="contract-section"><p className="contract-title font-bold">ç¬¬ä¸‰æ¢ï¼šè²¬ä»»æ“”ä¿æ¢æ¬¾ (é‡é»)</p>
                                            <ul className="list-none space-y-3 font-bold text-[11px] leading-relaxed">
                                                <li className="flex flex-col md:flex-row gap-1 md:gap-4"><span className="text-[#C5A059] w-20 shrink-0 uppercase tracking-widest">48 å°æ™‚å…§</span><span>æ¨™çš„å¯µç‰©äº¤ä»˜å¾Œï¼Œå¦‚è¨ºæ–·æ‚£æœ‰ç™¼é«˜ç‡’ã€å˜”åã€è‚ºç‚ï¼Œç¶“é†«é™¢é–‹ç«‹è­‰æ˜ï¼Œç”²æ–¹ç„¡æ¢ä»¶æ”¶å›æ›´æ›åŒç­‰å€¼å¹¼è²“ã€‚</span></li>
                                                <li className="flex flex-col md:flex-row gap-1 md:gap-4"><span className="text-[#C5A059] w-20 shrink-0 uppercase tracking-widest">7 å¤©å…§</span><span>å¦‚ç½¹æ‚£å‡ºè¡€æ€§è…¸ç‚ã€FIP å‚³æŸ“æ€§è…¹è†œç‚ï¼Œç¶“é†«é™¢è­‰æ˜ï¼Œç”²æ–¹ç„¡æ¢ä»¶æ”¶å›æ›´æ›åŒç­‰å€¼å¹¼è²“ã€‚</span></li>
                                                <li className="flex flex-col md:flex-row gap-1 md:gap-4"><span className="text-[#C5A059] w-20 shrink-0 uppercase tracking-widest">180 å¤©å…§</span><span>å…ˆå¤©æ€§éºå‚³å¿ƒè‡Ÿç—…ã€ç™²ç™‡ã€é’å…‰çœ¼ç–¾ç—…ï¼Œç”²æ–¹æ‡‰æ›´æ›åŒç­‰å€¼è²“éš»äºˆä¹™æ–¹ã€‚</span></li>
                                            </ul>
                                    </div>
                                    <div className="border-t-2 border-gray-100 pt-10 grid grid-cols-1 md:grid-cols-2 gap-10 text-[11px] font-bold text-gray-600">
                                            <div className="space-y-1"><h6 className="text-[#C5A059] uppercase tracking-widest mb-3 font-bold">è³£æ–¹ (ç”²æ–¹) å¥§å€«èŠåœ’</h6><p>çµ±ä¸€ç·¨è™Ÿï¼š88XXX888</p><p>è¨±å¯è­‰ï¼šç‰¹å¯µå­—ç¬¬SXXXXXXXXXXè™Ÿ</p></div>
                                            <div className="flex flex-col items-start md:items-end"><p className="mb-4 uppercase text-[#A8A29E] font-bold tracking-widest">è²·æ–¹æ•¸ä½ç°½ç½²</p><div onClick={() => setContractForm({...contractForm, signed: true})} className="w-full md:w-60 h-24 bg-white border border-gray-200 rounded-xl cursor-crosshair flex items-center justify-center text-gray-300 hover:border-[#C5A059] transition relative overflow-hidden group shadow-sm">{contractForm.signed ? <span className="font-cursive text-5xl text-[#3E362E] opacity-70 rotate-[-5deg] scale-110">{modal.data?.buyerName}</span> : <span className="text-[10px] uppercase font-bold tracking-widest opacity-40">Click to Sign</span>}</div></div>
                                    </div>
                                </div>
                            </div>
                            <div className="flex flex-col gap-6 pt-4">
                                <label className="flex items-start md:items-center gap-4 cursor-pointer group bg-white p-5 rounded-2xl border border-gray-100 shadow-sm"><input type="checkbox" className="w-6 h-6 rounded-lg border-2 border-gray-200 text-[#C5A059] focus:ring-0 cursor-pointer mt-1 md:mt-0" checked={contractForm.agree} onChange={e => setContractForm({...contractForm, agree: e.target.checked})} /><span className="font-bold text-gray-600 text-sm">æˆ‘å·²è©³é–±ä¸Šè¿° 10 æ¢åˆç´„æ¢æ¬¾èˆ‡é™„ç´„ç´°å‰‡ï¼Œç¢ºèªå®Œæˆé›»å­ç°½ç½²ã€‚</span></label>
                                <button disabled={!contractForm.agree || !contractForm.signed || isBusy} onClick={handleSigning} className={`w-full py-5 rounded-2xl font-bold shadow-2xl transition-all flex items-center justify-center gap-3 text-sm tracking-widest ${(!contractForm.agree || !contractForm.signed || isBusy) ? 'bg-gray-100 text-gray-300' : 'bg-[#1E1A17] text-[#C5A059] hover:bg-black btn-press shadow-xl'}`}>
                                    {isBusy ? <React.Fragment><div className="w-5 h-5 border-2 border-white/20 border-t-white rounded-full animate-spin"></div> åŠ å¯†å‚™ä»½ä¸­</React.Fragment> : <React.Fragment><Icon name="printer" /> ç¢ºèªç°½ç½²ä¸¦ç”Ÿæˆæ­£å¼è²·è³£å¥‘ç´„ PDF</React.Fragment>}
                                </button>
                            </div>
                        </div>
                    </Modal>

                    {/* 6. è²“éš»è©³ç´°è¡€çµ± Modal */}
                    <Modal isOpen={modal.type === 'kitten_detail'} onClose={() => setModal({type: null})} title={`è²“éš»æ ¸å¿ƒæª”æ¡ˆï¼š${modal.data?.name || ''}`}>
                        <div className="space-y-10 view-animate text-gray-800 font-bold">
                            <div className="flex flex-col md:flex-row gap-6 md:gap-10 items-center md:items-start bg-gray-50 p-6 md:p-10 rounded-3xl border border-gray-100 shadow-inner text-center md:text-left">
                                <div className="w-40 h-40 bg-white rounded-[2.5rem] flex items-center justify-center text-7xl shadow-xl shrink-0">ğŸ±</div>
                                <div className="flex-1 space-y-4">
                                    <h4 className="text-4xl font-serif font-bold tracking-tight">{modal.data?.name}</h4>
                                    <p className="text-xl font-bold text-[#C5A059] tracking-widest uppercase">{modal.data?.breed} <span className="text-gray-300 mx-2">|</span> {modal.data?.gender}</p>
                                    <div className="flex flex-col md:flex-row gap-4 md:gap-8 pt-4 text-xs font-bold justify-center md:justify-start"><div className="space-y-1"><p className="text-gray-400 uppercase tracking-widest text-[9px] font-extrabold">Microchip ID</p><p className="font-mono text-gray-800">{modal.data?.chip}</p></div><div className="space-y-1"><p className="text-gray-400 uppercase tracking-widest text-[9px] font-extrabold">Market Valuation</p><p className="text-[#C5A059] font-mono text-lg">${modal.data?.price}</p></div></div>
                                </div>
                            </div>
                            <div className="space-y-8">
                                <h5 className="font-bold text-[11px] uppercase tracking-[0.3em] text-gray-400 border-b pb-4 flex items-center gap-2"><Icon name="dna" size={14} className="text-[#C5A059]"/> äº”ä»£è¡€çµ±å¯è¦–åŒ–è¿½è¹¤</h5>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-12">
                                    <div><div className="pedigree-node font-bold border-[#C5A059] shadow-sm">SIRE (çˆ¶ç³»): {modal.data?.sire}</div><div className="pedigree-branch"><div className="pedigree-node italic font-medium">FATHER: GC RW Star Leo</div><div className="pedigree-branch"><div className="pedigree-node text-gray-400">GRAND: CH Golden King</div></div></div></div>
                                    <div><div className="pedigree-node font-bold border-[#C5A059] shadow-sm">DAM (æ¯ç³»): {modal.data?.dam}</div><div className="pedigree-branch"><div className="pedigree-node italic font-medium">MOTHER: CH Crystal Luna</div><div className="pedigree-branch"><div className="pedigree-node text-gray-400">GRAND: RW Bella Rose</div></div></div></div>
                                </div>
                            </div>
                            <button onClick={() => setModal({type: null})} className="w-full py-5 bg-gray-50 rounded-2xl font-bold text-gray-400 uppercase tracking-widest text-xs btn-press">é—œé–‰æ•¸æ“šæª”æ¡ˆ</button>
                        </div>
                    </Modal>

                    {/* 7. å…¨å±€æ–°å¢éŒ„å…¥ Modal */}
                    <Modal isOpen={modal.type === 'global_create'} onClose={() => setModal({type: null})} title="éŒ„å…¥èŠåœ’æ–°æ•¸æ“šè³‡ç”¢">
                        <div className="grid grid-cols-2 gap-4 md:gap-8">
                            {[
                                { t: 'æ–°å¢å¹¼è²“', i: 'cat', c: 'text-amber-600 bg-amber-50', tab: 'inventory' },
                                { t: 'ç”Ÿæˆåˆç´„', i: 'legal', c: 'text-emerald-600 bg-emerald-50', tab: 'legal' },
                                { t: 'ç™»è¨˜å®¶é•·', i: 'crm', c: 'text-blue-600 bg-blue-50', tab: 'crm' },
                                { t: 'éŒ„å…¥é˜²ç–«', i: 'medical', c: 'text-rose-600 bg-rose-50', tab: 'medical' }
                            ].map((b, i) => (
                                <button key={i} onClick={() => { setModal({type: null}); setActiveTab(b.tab); showToast(`å·²å•Ÿå‹•ã€${b.t}ã€‘å°ˆæ¥­å¼•å°æµç¨‹`); }} className="p-6 md:p-10 bg-white border border-gray-100 rounded-[2rem] md:rounded-[2.5rem] flex flex-col items-center gap-5 hover:border-[#C5A059] hover:shadow-2xl transition-all group btn-press shadow-sm">
                                    <div className={`p-4 md:p-5 rounded-2xl ${b.c} group-hover:scale-110 transition-transform shadow-inner`}><Icon name={b.i} size={32}/></div>
                                    <span className="font-extrabold uppercase tracking-[0.2em] text-gray-500 text-xs">{b.t}</span>
                                </button>
                            ))}
                        </div>
                    </Modal>

                    {/* 8. æˆåŠŸåé¥‹ Modal */}
                    <Modal isOpen={modal.type === 'success_feedback'} onClose={() => setModal({type: null})} title="ç³»çµ±ä½œæ¥­åŸ·è¡ŒæˆåŠŸ">
                        <div className="text-center py-10 text-gray-800 font-bold">
                            <div className="w-20 h-20 bg-emerald-50 text-emerald-600 rounded-full flex items-center justify-center mx-auto mb-6 shadow-sm"><Icon name="check" size={40}/></div>
                            <h4 className="text-2xl font-serif font-bold tracking-widest">èŠåœ’æ•¸æ“šè³‡ç”¢å·²æ›´æ–°</h4>
                            <p className="text-gray-400 mt-4 text-sm font-medium leading-relaxed px-4 md:px-10">{modal.data}</p>
                            <button onClick={() => setModal({type: null})} className="mt-10 w-full py-5 bg-[#1E1A17] text-[#C5A059] rounded-xl font-bold shadow-xl btn-press uppercase tracking-widest text-xs">äº†è§£ï¼Œå›åˆ°ä¸»é¢æ¿</button>
                        </div>
                    </Modal>

                    {/* 9. ç”ŸæˆæˆåŠŸ (åˆç´„å°ˆç”¨) */}
                    <Modal isOpen={modal.type === 'sign_success'} onClose={() => setModal({type: null})} title="æ•¸ä½å¥‘ç´„è™•ç†æˆåŠŸ">
                        <div className="text-center py-10 text-gray-800 font-bold">
                            <div className="w-20 h-20 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center mx-auto mb-6 shadow-sm"><Icon name="check" size={40}/></div>
                            <h4 className="text-2xl font-serif font-bold tracking-widest">å¥‘ç´„æ•¸æ“šå·²åŒæ­¥è‡³é›²ç«¯åº«</h4>
                            <p className="text-gray-400 mt-4 text-sm font-medium leading-relaxed px-4 md:px-10">æ­£å¼å‰¯æœ¬å·²ç™¼é€è‡³è²·æ–¹æ‰‹æ©Ÿé€²è¡Œæ³•å¾‹å‚™æ¡ˆï¼Œè©²è²“éš»ç‹€æ…‹å·²è‡ªå‹•è®Šæ›´ç‚ºã€å·²å”®å‡ºã€‘ä¸¦æ’å®šè¡€çµ±æ›¸è½‰è®“æ‰‹çºŒã€‚</p>
                            <button onClick={() => setModal({type: null})} className="mt-10 w-full py-5 bg-[#1E1A17] text-[#C5A059] rounded-xl font-bold shadow-xl btn-press uppercase tracking-widest text-xs">å›åˆ°ä¸»æ§åˆ¶å°</button>
                        </div>
                    </Modal>

                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
